<!DOCTYPE html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"/>
    <title>OpenGL - Polygonal Shading (Flat, Gouraud, Phong)</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<html>

<body>
    <div class="container">
        <hr>
        <h1>OpenGL - Polygonal Shading (Flat, Gouraud, Phong)</h1>
        <hr>
        <br>
        <p>一般在电脑上呈现的曲面都是由多边形近似完成的，那么我们应该如何为曲面着色呢？现在对于多边形的着色方法主要有三种：
        </p>
        <ul>
            <li> Flating Shading</li>
            <li> Gouraud Shading</li>
            <li> Phong Shading</li>
        </ul>
        <p>Gouraud Shading由于其渲染较快，效果也不错，所以成为PC最常用的着色方法。而近年来，随着GPU快速的发展，Phong Shading也逐渐应用在更真实的着色场景中。我们可以通过下图看出三者的效果差异：</p>
        <div class="clearfix"><img align=middle src="example1.PNG",width="300",height="305"></div>
        <p>
            从左到右分别是：Flat Shading -> Gouraud Shading -> Phong Shading
        </p>
        <br>

        <p> 1. Flat Shading:</p>
        <ul>
            <li> Enable with glShadeModel(GL_FLAT);</li>
            <li> Selects the computed color of just one vertex and assigns it to all the pixel fragments of the polygon</li>
            <li> Assessment: Inexpensive to compute; Less pleasant for smooth surfaces; Not pleasant even for flat surfaces</li>
        </ul>
        <pre>
        <code class="javascript highlight">
 //Flat Shading Code Example
 void init()
 {
	 GLfloat mat_specular[] = { 1.0, 1.0, 1.0, 0.0 };
	 GLfloat mat_shininess[] = { 50.0 };
	 GLfloat light_position[] = { 1.0, 1.0, 1.0, 0.0 };
	 glClearColor(0.0, 0.0, 0.0, 0.0);
	 glShadeModel(GL_SMOOTH);
	 glMaterialfv(GL_FRONT, GL_SPECULAR, mat_specular);
	 glMaterialfv(GL_FRONT, GL_SHININESS, mat_shininess);
	 glLightfv(GL_LIGHT0, GL_POSITION, light_position);
	 glEnable(GL_LIGHTING);
	 glEnable(GL_LIGHT0);
	 glEnable(GL_DEPTH_TEST);
	 glShadeModel(GL_FLAT);
 }
             </code>
        </pre>
        <br>
        <p> 2. Gouraud Shading:</p>
        <ul>
            <li> Enable with glShadeModel(GL_SMOOTH);</li>
            <li> Calculate color at each vertex</li>
            <li> Interpolate the vertex color for the interior</li>
            <li> Assessment: Better image; More expensive to calculate than flat shading</li>
        </ul>
        <br>
        <p> 3. Phong Shading:</p>
        <ul>
            <li> Interpolate normals rather than colors (Shading needs to be done for every fragment (pixel)</li>
            <li> Significantly more expensive</li>
            <li> Not supported in OpenGL (You should write your own Phong shader using GLSL)</li>
        </ul>
        <div class="clearfix"><img align=middle src="phong1.png"></div>
        <br>
        <p>简单用中文概括三种着色方式的特点：</p>
        <ul>
            <li> Flating Shading: 用多边形平面的法向量计算出光照下当前多边形平面的颜色，然后用单一色对整个面进行着色。</li>
            <li> Gouraud Shading: 多边形的每个定点都有各自的法向量，接受光照时多边形的各定点都有各自的颜色，然后根据双线性插值 (bilinear interpolation)来求得的颜色对多边形进行作色，Gouraud Shading也被称为Per-Vertex着色</li>
            <li> Phong Shading: 结合了多边形物体表面反射光的亮度，并以特定片段 (像素) 的表面法线作为像素参考值来对平面着色，Phong Shading也被称为Per-Pixel像素着色。</li>
        </ul>
        <br>
        <div class="clearfix"><img align=middle src="example2.png", width="500",height ="420"></div>
        <br>
        <p>
            现在我们来分析各自的时间复杂度：
        </p>
        <p>
            假设构成曲面几何体的多边形为三角形, 三角形面积为A, 三角形个数为N, 着色一次的计算量L(着色一次需要6次乘法和2次加法和1次查表运算), 双线性插值的时间复杂度设为B。
        </p>
        <br>
        <p> O(Flating Shading): N * L</p>
        <p> O(Gouraud Shading): N * (3 * L + B * A)</p>
        <p> O(Phong Shading): ：(B + L) * N * A</p>
        <br>
        <p>
            我们可以看出对于时间复杂度：Flat < Gouraud < Phong Shading。这也说明了为何早起电脑都只支持Gouraud shading，但随着GPU的迅速发展，Phong Shading的效能已得到提升。
        </p>
        <br>
        <hr>
        <h3>参考文章</h3>
        <ul>
            <li><a href="https://cg2010studio.com/2011/11/01/flat%E3%80%81gouraud%E3%80%81phong-shading%E7%9A%84%E5%B7%AE%E5%88%A5-comparison-flat-gouraud-phong-shading/"> Comparision flat, gouraud, phong shading</a></li>
            <li><a href="http://fanli7.net/a/bianchengyuyan/_NET/20121230/281295.html"> [OpenGL ES 07-1]光照原理</a></li>
        </ul>
        <hr>
    </div>
</body>
<script src="js/js.js"></script>
<script src="js/jquery-3.2.1.min.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
<link rel="stylesheet" href="css/solarized-light.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>

<script>
    $(document).ready(function () {
        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });
    });
</script>
</html>
